import{r as t,c as s,h as i,H as d,g as e}from"./p-6c77ad03.js";import{c as h}from"./p-4353a1fe.js";import{s as a}from"./p-9f54bbf7.js";import{s as o,a as n}from"./p-d12de105.js";import{c as r,b as c,f as p,p as f}from"./p-7ef7a29b.js";import{g as l}from"./p-7f0894df.js";const u="spx-edit-button",m=class{constructor(i){t(this,i),this.spxEditButtonDidLoad=s(this,"spxEditButtonDidLoad",7),this.spxEditButtonDiscard=s(this,"spxEditButtonDiscard",7),this.spxEditButtonSave=s(this,"spxEditButtonSave",7),this.loading=!1,this.open=!1,this.test=!1,this.background="var(--spx-color-gray-900)",this.backgroundDiscard="var(--spx-color-gray-600)",this.border="none",this.borderRadius=r,this.color="#ffffff",this.colorDiscard="#ffffff",this.distanceX="1em",this.distanceY="1em",this.fontFamily=c,this.fontSize=p,this.fontSizeMin=1,this.fontSizeMax=1.2,this.gap="0.4em",this.padding="0.8em 1.2em",this.paddingXMin=1,this.paddingXMax=1.4,this.paddingYMin=.7,this.paddingYMax=1.2,this.position="bottom-right",this.positionCss="fixed",this.styling="default",this.textDiscard="Discard",this.textEdit="Edit site",this.textSave="Save",this.textSuccess="Save was successful",this.zIndex=99,this.clickEdit=()=>{this.open=!0,(this.editId?document.querySelectorAll("[data-spx-edit][data-spx-edit-id="+this.editId+"]"):document.querySelectorAll("[data-spx-edit]")).forEach((t=>{const s=document.createElement("spx-edit"),i=t.getAttribute("data-spx-edit"),d=t.getAttribute("data-spx-edit-type"),e=t.hasAttribute("data-spx-edit-subfield"),h=t.innerHTML;i&&s.setAttribute("name",i),d&&s.setAttribute("type",d),e&&s.setAttribute("subfield",""),s.innerHTML=h,s.setAttribute("editable",""),t.innerHTML="",t.appendChild(s)}))},this.clickDiscard=()=>{this.open=!1,this.spxEditButtonDiscard.emit({target:"document"})},this.clickSave=()=>{this.loading=!0;const t=()=>{const t=document.createElement("spx-snackbar");t.setAttribute("text",this.textSuccess),document.body.appendChild(t),document.querySelectorAll("spx-edit").forEach((t=>{t.parentElement.innerHTML=t.innerHTML})),this.spxEditButtonSave.emit({target:"document"}),this.open=!1,this.loading=!1};this.test?t():fetch(spx.ajax,{method:"POST",credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded"}),body:"action=spxEditButtonAjaxHandler"+(()=>{const t=Math.random().toString(36).substr(2,9),s=[];return document.querySelectorAll("spx-edit").forEach((i=>{const d=i.getAttribute("body-string").replace("&","").replace("=",t),e=encodeURIComponent(d);s.push(("&"+e).replace(t,"="))})),s.toString().replace(/,&/g,"&")})()+"&post_id="+spx.postId}).then((s=>{200===s.status?t():500===s.status&&(this.loading=!1)}))}}positionChanged(){this.createPositionArray()}componentWillLoad(){this.createPositionArray()}componentDidLoad(){l(this.el),this.spxEditButtonDidLoad.emit({target:"document"})}createPositionArray(){this.positionArray=this.position.split("-")}async discard(){this.clickDiscard()}async edit(){this.clickEdit()}async reload(){this.componentWillLoad()}async save(){this.clickSave()}render(){const t=("default"===this.styling||"fluid"===this.styling)&&h(Object.assign(Object.assign({},f("edit-button",this.positionArray,this.distanceX,this.distanceY)),{fontFamily:c,fontSize:o(u,"font-size",this.fontSize,this.fontSizeMin,this.fontSizeMax,this.styling),display:"grid",gridGap:a(u,"gap",this.gap),position:this.positionCss,zIndex:this.zIndex})),s="default"===this.styling||"fluid"===this.styling?h({fontFamily:a(u,"font-family",this.fontFamily),display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center",cursor:"pointer",fontSize:"1em",padding:"default"===this.styling&&a(u,"padding",this.padding),paddingLeft:"fluid"===this.styling&&n(u,"padding-x",this.paddingXMin,this.paddingXMax),paddingRight:"fluid"===this.styling&&n(u,"padding-x",this.paddingXMin,this.paddingXMax),paddingTop:"fluid"===this.styling&&n(u,"padding-x",this.paddingYMin,this.paddingYMax),paddingBottom:"fluid"===this.styling&&n(u,"padding-x",this.paddingYMin,this.paddingYMax),color:a(u,"color",this.color),background:a(u,"background",this.background),border:a(u,"border",this.border),borderRadius:a(u,"border-radius",this.borderRadius)}):this.classButton,e="default"===this.styling||"fluid"===this.styling?h({color:a(u,"color-discard",this.colorDiscard),background:a(u,"background-discard",this.backgroundDiscard)}):this.classButtonDiscard,r="default"===this.styling||"fluid"===this.styling?h({paddingRight:"0.25em"}):this.classLoader;return i(d,{class:t},this.open?[i("button",{onClick:this.clickDiscard,class:h([s,e])},this.textDiscard||i("slot",{name:"discard"})),i("button",{onClick:this.clickSave,class:s},this.loading&&i("spx-loader",{class:r}),this.textSave||i("slot",{name:"save"}))]:i("button",{onClick:this.clickEdit,class:s},this.textEdit||i("slot",{name:"edit"})))}get el(){return e(this)}static get watchers(){return{position:["positionChanged"]}}};export{m as spx_edit_button}