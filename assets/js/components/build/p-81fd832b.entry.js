import{r as t,d as s,h as i,H as e,a as o}from"./p-e1defc51.js";import{c as a}from"./p-cfbebfdc.js";import{s as d}from"./p-33315b75.js";import"./p-a1c5e2d4.js";import"./p-3333ff2d.js";import"./p-d1ae8003.js";import"./p-5cc7fca6.js";import"./p-6cdc03eb.js";import{g as n}from"./p-9e5127cc.js";import{b as r,f as h,d as c,p}from"./p-8066be7a.js";const m="spx-edit-button",l=class{constructor(i){t(this,i),this.spxEditButtonDiscard=s(this,"spxEditButtonDiscard",7),this.spxEditButtonSave=s(this,"spxEditButtonSave",7),this.loading=!1,this.open=!1,this.test=!1,this.background="var(--spx-color-gray-900)",this.backgroundDiscard="var(--spx-color-gray-600)",this.border="none",this.borderRadius=r,this.color="#ffffff",this.colorDiscard="#ffffff",this.distanceX="1em",this.distanceY="1em",this.fontFamily=h,this.fontSize=c,this.gap="0.4em",this.padding="0.8em 1.2em",this.position="bottom-right",this.positionCss="fixed",this.textDiscard="Discard",this.textEdit="Edit site",this.textSave="Save",this.textSuccess="Save was successful",this.zIndex=99,this.clickEdit=()=>{this.open=!0,(this.editId?document.querySelectorAll("[data-spx-edit][data-spx-edit-id="+this.editId+"]"):document.querySelectorAll("[data-spx-edit]")).forEach(t=>{const s=document.createElement("spx-edit"),i=t.getAttribute("data-spx-edit"),e=t.getAttribute("data-spx-edit-type"),o=t.hasAttribute("data-spx-edit-subfield"),a=t.innerHTML;i&&s.setAttribute("name",i),e&&s.setAttribute("type",e),o&&s.setAttribute("subfield",""),s.innerHTML=a,s.setAttribute("editable",""),t.innerHTML="",t.appendChild(s)})},this.clickDiscard=()=>{this.open=!1,this.spxEditButtonDiscard.emit({target:"document"})},this.clickSave=()=>{this.loading=!0;const t=()=>{const t=document.createElement("spx-snackbar");t.setAttribute("text",this.textSuccess),document.body.appendChild(t),document.querySelectorAll("spx-edit").forEach(t=>{t.parentElement.innerHTML=t.innerHTML}),this.spxEditButtonSave.emit({target:"document"}),this.open=!1,this.loading=!1};this.test?t():fetch(spx.ajax,{method:"POST",credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded"}),body:"action=spxEditButtonAjaxHandler"+(()=>{const t=Math.random().toString(36).substr(2,9),s=[];return document.querySelectorAll("spx-edit").forEach(i=>{const e=i.getAttribute("body-string").replace("&","").replace("=",t),o=encodeURIComponent(e);s.push(("&"+o).replace(t,"="))}),console.log(s.toString().replace(/,&/g,"&")),s.toString().replace(/,&/g,"&")})()+"&post_id="+spx.postId}).then(s=>{200===s.status?t():500===s.status&&(this.loading=!1)})}}positionChanged(){this.createPositionArray()}componentWillLoad(){this.createPositionArray()}componentDidLoad(){n(this.el)}createPositionArray(){this.positionArray=this.position.split("-")}async reload(){this.componentWillLoad()}render(){const t=a(Object.assign(Object.assign({},p("edit-button",this.positionArray,this.distanceX,this.distanceY)),{fontFamily:h,fontSize:d(m,"font-size",this.fontSize),display:"grid",gridGap:d(m,"gap",this.gap),position:this.positionCss,zIndex:this.zIndex})),s=a({fontFamily:d(m,"font-family",this.fontFamily),display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center",cursor:"pointer",fontSize:"1em",padding:d(m,"padding",this.padding),color:d(m,"color",this.color),background:d(m,"background",this.background),border:d(m,"border",this.border),borderRadius:d(m,"border-radius",this.borderRadius)}),o=a({color:d(m,"color-discard",this.colorDiscard),background:d(m,"background-discard",this.backgroundDiscard)}),n=a({paddingRight:"8px"});return i(e,{class:t},this.open?[i("button",{onClick:this.clickDiscard,class:a([s,o])},this.textDiscard||i("slot",{name:"discard"})),i("button",{onClick:this.clickSave,class:s},this.loading&&i("spx-loader",{class:n}),this.textSave||i("slot",{name:"save"}))]:i("button",{onClick:this.clickEdit,class:s},this.textEdit||i("slot",{name:"edit"})))}get el(){return o(this)}static get watchers(){return{position:["positionChanged"]}}};export{l as spx_edit_button}