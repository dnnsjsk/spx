import{r as t,c as s,h as i,H as a,a as d}from"./p-d8297fdb.js";import{b as h,d as e,e as o,s as n}from"./p-ae086eeb.js";import{b as r,d as c,e as l,c as p,p as u,s as f,h as m,t as g,a as x,f as b}from"./p-d099ae82.js";import{c as y}from"./p-f14c302d.js";import{B as v}from"./p-afec7fc6.js";import"./p-a6008498.js";const j="spx-edit-button",k=class{constructor(i){t(this,i),this.spxEditButtonDidLoad=s(this,"spxEditButtonDidLoad",7),this.spxEditButtonDiscard=s(this,"spxEditButtonDiscard",7),this.spxEditButtonSave=s(this,"spxEditButtonSave",7),this.loading=!1,this.open=!1,this.test=!1,this.background="var(--spx-color-gray-900)",this.backgroundDiscard="var(--spx-color-gray-600)",this.border="none",this.borderRadius=r,this.color="#ffffff",this.colorDiscard="#ffffff",this.display=c,this.distanceX="1em",this.distanceY="1em",this.fontFamily=l,this.fontSize=p,this.fontSizeMax=1.2,this.fontSizeMin=1,this.gap="0.4em",this.loaderColor="#ffffff",this.loaderGap="0.5em",this.padding="0.7em 1.2em",this.paddingXMin=1,this.paddingXMax=1.4,this.paddingYMin=.7,this.paddingYMax=1.2,this.position="bottom-right",this.positionCss="fixed",this.styling="default",this.textDiscard="Discard",this.textEdit="Edit site",this.textSave="Save",this.textSuccess="Save was successful",this.zIndex=99,this.createPositionArray=()=>{this.positionArray=this.position.split("-")},this.clickEdit=()=>{this.open=!0,(this.editId?document.querySelectorAll("[data-spx-edit][data-spx-edit-id="+this.editId+"]"):document.querySelectorAll("[data-spx-edit]")).forEach((t=>{const s=document.createElement("spx-edit"),i=t.getAttribute("data-spx-edit"),a=t.getAttribute("data-spx-edit-type"),d=t.hasAttribute("data-spx-edit-subfield"),h=t.innerHTML;i&&s.setAttribute("name",i),a&&s.setAttribute("type",a),d&&s.setAttribute("subfield",""),s.innerHTML=h,s.setAttribute("editable",""),t.innerHTML="",t.appendChild(s)}))},this.clickDiscard=()=>{this.open=!1,this.spxEditButtonDiscard.emit({target:"document"})},this.clickSave=()=>{this.loading=!0;const t=()=>{const t=document.createElement("spx-snackbar");t.setAttribute("text",this.textSuccess),document.body.appendChild(t),document.querySelectorAll("spx-edit").forEach((t=>{t.parentElement.innerHTML=t.innerHTML})),this.spxEditButtonSave.emit({target:"document"}),this.open=!1,this.loading=!1};this.test?t():fetch(spx.ajax,{method:"POST",credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded"}),body:"action=spxEditButtonAjaxHandler"+(()=>{const t=Math.random().toString(36).substr(2,9),s=[];return document.querySelectorAll("spx-edit").forEach((i=>{const a=i.getAttribute("body-string").replace("&","").replace("=",t),d=encodeURIComponent(a);s.push(("&"+d).replace(t,"="))})),s.toString().replace(/,&/g,"&")})()+"&post_id="+spx.postId}).then((s=>{200===s.status?t():500===s.status&&(this.loading=!1)}))}}positionChanged(){this.createPositionArray()}componentWillLoad(){this.createPositionArray()}componentDidLoad(){h({el:this.el}),this.spxEditButtonDidLoad.emit({target:"document"})}componentWillUpdate(){e(this.el)}async discard(){this.clickDiscard()}async edit(){this.clickEdit()}async save(){this.clickSave()}render(){var t,s,d,h;const{tw:e,css:r}=y(this.el.shadowRoot),c=o({display:n(j,"display",this.display)}),p=("default"===this.styling||"fluid"===this.styling)&&e(r(Object.assign(Object.assign({},u("edit-button",this.positionArray,this.distanceX,this.distanceY)),{fontFamily:l,fontSize:f(j,"font-size",this.fontSize,this.fontSizeMin,this.fontSizeMax,this.styling),display:"grid",gridGap:n(j,"gap",this.gap),position:this.positionCss,zIndex:this.zIndex}))),k=e("default"===this.styling||"fluid"===this.styling?r(Object.assign({fontFamily:n(j,"font-family",this.fontFamily),display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center",cursor:"pointer",fontSize:"1em",padding:"default"===this.styling&&n(j,"padding",this.padding),paddingLeft:"fluid"===this.styling&&m(j,"padding-x",this.paddingXMin,this.paddingXMax),paddingRight:"fluid"===this.styling&&m(j,"padding-x",this.paddingXMin,this.paddingXMax),paddingTop:"fluid"===this.styling&&m(j,"padding-x",this.paddingYMin,this.paddingYMax),paddingBottom:"fluid"===this.styling&&m(j,"padding-x",this.paddingYMin,this.paddingYMax),color:n(j,"color",this.color),background:n(j,"background",this.background),border:n(j,"border",this.border),borderRadius:n(j,"border-radius",this.borderRadius),transitionProperty:"background, box-shadow",transitionDuration:g,transitionTimingFunction:x},b)):null!==(t=this.classButton)&&void 0!==t?t:""),w=e("default"===this.styling||"fluid"===this.styling?r({color:n(j,"color-discard",this.colorDiscard),background:n(j,"background-discard",this.backgroundDiscard)}):(null!==(s=this.classButton)&&void 0!==s?s:"")+" "+(null!==(d=this.classButtonDiscard)&&void 0!==d?d:"")),C=e("default"===this.styling||"fluid"===this.styling?r({marginRight:n(j,"loader-gap",this.loaderGap)}):null!==(h=this.classLoader)&&void 0!==h?h:"");return i(a,{class:c},i("div",{class:p},this.open?[i(v,{as:"button",onClick:this.clickDiscard,class:"headless"===this.styling?w:k+" "+w},this.textDiscard||i("slot",{name:"discard"})),i(v,{as:"button",onClick:this.clickSave,class:k},this.loading&&i("spx-icon",{class:C,type:"loader",color:n(j,"loader-color",this.loaderColor)}),this.textSave||i("slot",{name:"save"}))]:i("button",{onClick:this.clickEdit,class:k},this.textEdit||i("slot",{name:"edit"}))))}get el(){return d(this)}static get watchers(){return{position:["positionChanged"]}}};export{k as spx_edit_button}