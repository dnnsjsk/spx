import{r as t,c as i,h as n,H as r,a as o}from"./p-d8297fdb.js";import{c as s,a as e,h as a,b as u,d as c,e as h,s as f}from"./p-ae086eeb.js";import{w as v}from"./p-2349d400.js";import{c as d}from"./p-70de8434.js";import{d as m}from"./p-d099ae82.js";import{h as p}from"./p-175d0e83.js";import"./p-a6008498.js";import"./p-dc57ceb6.js";var l=s((function(t){t.exports=function(){function t(t,i){for(var n=t.length,r=n,o=[];n--;)o.push(i(t[r-n-1]));return o}function i(t,i){if(window.Promise)return g(t,i,arguments.length>2&&void 0!==arguments[2]&&arguments[2]);t.recalculate(!0,!0)}function n(t){var i=t.useContainerForBreakpoints?t.container.clientWidth:window.innerWidth,n={columns:t.columns};n.margin=x(t.margin)?{x:t.margin.x,y:t.margin.y}:{x:t.margin,y:t.margin};var r=Object.keys(t.breakAt);return t.mobileFirst?function(t){for(var i=t.options,n=t.responsiveOptions,r=t.keys,o=t.docWidth,s=0;s<r.length;s++){var e=parseInt(r[s],10);o>=e&&b(i.breakAt[e],n)}return n}({options:t,responsiveOptions:n,keys:r,docWidth:i}):function(t){for(var i=t.options,n=t.responsiveOptions,r=t.keys,o=t.docWidth,s=r.length-1;s>=0;s--){var e=parseInt(r[s],10);o<=e&&b(i.breakAt[e],n)}return n}({options:t,responsiveOptions:n,keys:r,docWidth:i})}function r(t){return n(t).columns}function o(t){return n(t).margin}function s(t){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=r(t),s=o(t).x,e=100/n;if(!i)return e;if(1===n)return"100%";var a="px";if("string"==typeof s){var u=parseFloat(s);a=s.replace(u,""),s=u}return s=(n-1)*s/n,"%"===a?e-s+"%":"calc("+e+"% - "+s+a+")"}function e(t,i){var n,e=r(t.options),a=0,u=void 0;if(1==++i)return 0;var c="px";if("string"==typeof(u=o(t.options).x)){var h=parseFloat(u,10);c=u.replace(h,""),u=h}return n=(u-(e-1)*u/e)*(i-1),a+=s(t.options,!1)*(i-1),"%"===c?a+n+"%":"calc("+a+"% + "+n+c+")"}function a(t){var i=0,n=t.container;f(t.rows,(function(t){i=t>i?t:i})),n.style.height=i+"px"}function u(t,i){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],e=r(t.options),u=o(t.options).y;I(t,e,n),f(i,(function(i){var n=0,r=parseInt(i.offsetHeight,10);isNaN(r)||(t.rows.forEach((function(i,r){i<t.rows[n]&&(n=r)})),i.style.position="absolute",i.style.top=t.rows[n]+"px",i.style.left=""+t.cols[n],t.rows[n]+=isNaN(r)?0:r+u,s&&(i.dataset.macyComplete=1))})),s&&(t.tmpRows=null),a(t)}function c(t,i){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],e=r(t.options),u=o(t.options).y;I(t,e,n),f(i,(function(i){t.lastcol===e&&(t.lastcol=0);var n=A(i,"height");n=parseInt(i.offsetHeight,10),isNaN(n)||(i.style.position="absolute",i.style.top=t.rows[t.lastcol]+"px",i.style.left=""+t.cols[t.lastcol],t.rows[t.lastcol]+=isNaN(n)?0:n+u,t.lastcol+=1,s&&(i.dataset.macyComplete=1))})),s&&(t.tmpRows=null),a(t)}var h=function t(i,n){if(!(this instanceof t))return new t(i,n);if(i&&i.nodeName)return i;if(i=i.replace(/^\s*/,"").replace(/\s*$/,""),n)return this.byCss(i,n);for(var r in this.selectors)if(n=r.split("/"),new RegExp(n[1],n[2]).test(i))return this.selectors[r](i);return this.byCss(i)};h.prototype.byCss=function(t,i){return(i||document).querySelectorAll(t)},(h.prototype.selectors={})[/^\.[\w\-]+$/]=function(t){return document.getElementsByClassName(t.substring(1))},h.prototype.selectors[/^\w+$/]=function(t){return document.getElementsByTagName(t)},h.prototype.selectors[/^\#[\w\-]+$/]=function(t){return document.getElementById(t.substring(1))};var f=function(t,i){for(var n=t.length,r=n;n--;)i(t[r-n-1])},v=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.running=!1,this.events=[],this.add(t)};v.prototype.run=function(){if(!this.running&&this.events.length>0){var t=this.events.shift();this.running=!0,t(),this.running=!1,this.run()}},v.prototype.add=function(){var t=this,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return!!i&&(Array.isArray(i)?f(i,(function(i){return t.add(i)})):(this.events.push(i),void this.run()))},v.prototype.clear=function(){this.events=[]};var d=function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.instance=t,this.data=i,this},m=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.events={},this.instance=t};m.prototype.on=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!(!t||!i)&&(Array.isArray(this.events[t])||(this.events[t]=[]),this.events[t].push(i))},m.prototype.emit=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t||!Array.isArray(this.events[t]))return!1;var n=new d(this.instance,i);f(this.events[t],(function(t){return t(n)}))};var p=function(t){return!("naturalHeight"in t&&t.naturalHeight+t.naturalWidth===0)||t.width+t.height!==0},l=function(t,i){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Promise((function(t,n){if(i.complete)return p(i)?t(i):n(i);i.addEventListener("load",(function(){return p(i)?t(i):n(i)})),i.addEventListener("error",(function(){return n(i)}))})).then((function(i){n&&t.emit(t.constants.EVENT_IMAGE_LOAD,{img:i})})).catch((function(i){return t.emit(t.constants.EVENT_IMAGE_ERROR,{img:i})}))},y=function(i,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t(n,(function(t){return l(i,t,r)}))},g=function(t,i){return Promise.all(y(t,i,arguments.length>2&&void 0!==arguments[2]&&arguments[2])).then((function(){t.emit(t.constants.EVENT_IMAGE_COMPLETE)}))},w=function(t){return function(t,i){var n=void 0;return function(){n&&clearTimeout(n),n=setTimeout(t,i)}}((function(){t.emit(t.constants.EVENT_RESIZE),t.queue.add((function(){return t.recalculate(!0,!0)}))}),100)},E=function(t){(function(t){if(t.container=h(t.options.container),t.container instanceof h||!t.container)return!!t.options.debug&&console.error("Error: Container not found");t.container.length&&(t.container=t.container[0]),t.options.container=t.container,t.container.style.position="relative"})(t),function(t){t.queue=new v,t.events=new m(t),t.rows=[],t.resizer=w(t)}(t),function(t){var n=h("img",t.container);window.addEventListener("resize",t.resizer),t.on(t.constants.EVENT_IMAGE_LOAD,(function(){return t.recalculate(!1,!1)})),t.on(t.constants.EVENT_IMAGE_COMPLETE,(function(){return t.recalculate(!0,!0)})),t.options.useOwnImageLoader||i(t,n,!t.options.waitForImages),t.emit(t.constants.EVENT_INITIALIZED)}(t)},x=function(t){return t===Object(t)&&"[object Array]"!==Object.prototype.toString.call(t)},b=function(t,i){x(t)||(i.columns=t),x(t)&&t.columns&&(i.columns=t.columns),x(t)&&t.margin&&!x(t.margin)&&(i.margin={x:t.margin,y:t.margin}),x(t)&&t.margin&&x(t.margin)&&t.margin.x&&(i.margin.x=t.margin.x),x(t)&&t.margin&&x(t.margin)&&t.margin.y&&(i.margin.y=t.margin.y)},A=function(t,i){return window.getComputedStyle(t,null).getPropertyValue(i)},I=function(t,i){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(t.lastcol||(t.lastcol=0),t.rows.length<1&&(n=!0),n){t.rows=[],t.cols=[],t.lastcol=0;for(var r=i-1;r>=0;r--)t.rows[r]=0,t.cols[r]=e(t,r)}else if(t.tmpRows)for(t.rows=[],r=i-1;r>=0;r--)t.rows[r]=t.tmpRows[r];else for(t.tmpRows=[],r=i-1;r>=0;r--)t.tmpRows[r]=t.rows[r]},N=function(t){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=i?t.container.children:h(':scope > *:not([data-macy-complete="1"])',t.container);r=Array.from(r).filter((function(t){return null!==t.offsetParent}));var o=s(t.options);return f(r,(function(t){i&&(t.dataset.macyComplete=0),t.style.width=o})),t.options.trueOrder?(c(t,r,i,n),t.emit(t.constants.EVENT_RECALCULATED)):(u(t,r,i,n),t.emit(t.constants.EVENT_RECALCULATED))},O=function(){return!!window.Promise},j=Object.assign||function(t){for(var i=1;i<arguments.length;i++){var n=arguments[i];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};Array.from||(Array.from=function(t){for(var i=0,n=[];i<t.length;)n.push(t[i++]);return n});var L={columns:4,margin:2,trueOrder:!1,waitForImages:!1,useImageLoader:!0,breakAt:{},useOwnImageLoader:!1,onInit:!1,cancelLegacy:!1,useContainerForBreakpoints:!1};!function(){try{document.createElement("a").querySelector(":scope *")}catch(t){!function(){function t(t){return function(n){if(n&&i.test(n)){var r=this.getAttribute("id");r||(this.id="q"+Math.floor(9e6*Math.random())+1e6),arguments[0]=n.replace(i,"#"+this.id);var o=t.apply(this,arguments);return null===r?this.removeAttribute("id"):r||(this.id=r),o}return t.apply(this,arguments)}}var i=/:scope\b/gi,n=t(Element.prototype.querySelector);Element.prototype.querySelector=function(t){return n.apply(this,arguments)};var r=t(Element.prototype.querySelectorAll);Element.prototype.querySelectorAll=function(t){return r.apply(this,arguments)}}()}}();var T=function t(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L;if(!(this instanceof t))return new t(i);this.options={},j(this.options,L,i),this.options.cancelLegacy&&!O()||E(this)};return T.init=function(t){return console.warn("Depreciated: Macy.init will be removed in v3.0.0 opt to use Macy directly like so Macy({ /*options here*/ }) "),new T(t)},T.prototype.recalculateOnImageLoad=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return i(this,h("img",this.container),!t)},T.prototype.runOnImageLoad=function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=h("img",this.container);return this.on(this.constants.EVENT_IMAGE_COMPLETE,t),n&&this.on(this.constants.EVENT_IMAGE_LOAD,t),i(this,r,n)},T.prototype.recalculate=function(){var t=this,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return n&&this.queue.clear(),this.queue.add((function(){return N(t,i,n)}))},T.prototype.remove=function(){window.removeEventListener("resize",this.resizer),f(this.container.children,(function(t){t.removeAttribute("data-macy-complete"),t.removeAttribute("style")})),this.container.removeAttribute("style")},T.prototype.reInit=function(){this.recalculate(!0,!0),this.emit(this.constants.EVENT_INITIALIZED),window.addEventListener("resize",this.resizer),this.container.style.position="relative"},T.prototype.on=function(t,i){this.events.on(t,i)},T.prototype.emit=function(t,i){this.events.emit(t,i)},T.prototype.constants=T.constants={EVENT_INITIALIZED:"macy.initialized",EVENT_RECALCULATED:"macy.recalculated",EVENT_IMAGE_LOAD:"macy.image.load",EVENT_IMAGE_ERROR:"macy.image.error",EVENT_IMAGE_COMPLETE:"macy.images.complete",EVENT_RESIZE:"macy.resize"},T}()}));const y=class{constructor(n){t(this,n),this.spxMasonryDidLoad=i(this,"spxMasonryDidLoad",7),this.columns=4,this.display=m,this.gap="10px",this.initMacy=()=>{Array.from(this.container.children).forEach((t=>{v(t,document.createElement("div"))})),this.macyState=l({container:this.container,margin:0,mobileFirst:!0,runOnImageLoad:!0,columns:this.columns,breakAt:this.bpColumns?this.bpColumnsObject:{9999:this.columns?this.columns:4}})},this.update=()=>{this.macyState.remove(),this.container.innerHTML="",this.content=this.el.innerHTML,setTimeout((()=>{a({el:this.el,condition:this.lazy}),this.initMacy()}),100)}}imagesChanged(t){t&&(this.imagesArray=JSON.parse(t))}componentWillLoad(){this.content=this.el.innerHTML,this.images&&this.imagesChanged(this.images)}componentDidLoad(){u({el:this.el,lazy:this.lazy,cb:this.update}),this.bpColumns&&(this.bpColumnsObject=JSON.parse("{"+this.bpColumns.replace(/([0-9]+)/g,'"$1"')+"}")),this.initMacy(),this.spxMasonryDidLoad.emit({target:"document"})}componentWillUpdate(){c(this.el)}componentDidUpdate(){this.macyState.reInit()}disconnectedCallback(){this.macyState.remove()}render(){const{css:t}=d(this.el.shadowRoot),i=h({display:f("spx-masonry","display",this.display)}),o=t({margin:"calc(var(--spx-masonry-gap, "+this.gap+") * -1) calc(var(--spx-masonry-gap, "+this.gap+") / 2 * -1) 0 calc(var(--spx-masonry-gap, "+this.gap+") / 2 * -1)","& > div":{padding:"var(--spx-masonry-gap, "+this.gap+") calc(var(--spx-masonry-gap, "+this.gap+") / 2) 0 calc(var(--spx-masonry-gap, "+this.gap+") / 2)",boxSizing:"border-box","*":{width:"100%",maxWidth:"100%"},img:{verticalAlign:"top"}}});return n(r,{class:i},p({class:o,condition:this.images,content:this.content,el:this.el,ref:t=>this.container=t,helper:{array:this.imagesArray,el:this.el,images:this.images,lazy:this.lazy,size:this.imageSize,src:this.imageSrc}}))}get el(){return o(this)}static get watchers(){return{images:["imagesChanged"]}}};export{y as spx_masonry}